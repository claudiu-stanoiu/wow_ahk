<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WoW Key Repeat + Overlay System</title>
  <style>
    :root {
      --bg: #0b1020;
      --bg-alt: #141a2b;
      --card-bg: #181f35;
      --accent: #4fd1c5;
      --accent-soft: rgba(79, 209, 197, 0.12);
      --accent-strong: #38b2ac;
      --danger: #f56565;
      --danger-soft: rgba(245, 101, 101, 0.12);
      --text-main: #e2e8f0;
      --text-muted: #a0aec0;
      --border-subtle: rgba(226, 232, 240, 0.1);
      --code-bg: #111827;
      --mono: "Fira Code", Menlo, Monaco, Consolas, "Courier New", monospace;
      --sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --radius-lg: 14px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.45);
      --shadow-subtle: 0 0 0 1px rgba(148, 163, 184, 0.24);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 32px 16px 48px;
      background: radial-gradient(circle at top, #1a2140 0, #050816 40%, #020309 100%);
      color: var(--text-main);
      font-family: var(--sans);
      line-height: 1.6;
      display: flex;
      justify-content: center;
    }

    .container {
      max-width: 980px;
      width: 100%;
    }

    .card {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.92));
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 28px 28px 32px;
      backdrop-filter: blur(18px);
    }

    h1, h2, h3, h4 {
      font-weight: 650;
      letter-spacing: 0.02em;
      color: #f9fafb;
      margin-top: 0;
    }

    h1 {
      font-size: 2.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }

    .badge {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-muted);
    }

    .subtitle {
      color: var(--text-muted);
      margin-bottom: 20px;
      font-size: 0.95rem;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 22px;
    }

    .pill {
      font-size: 0.78rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
      background: radial-gradient(circle at top left, rgba(148, 163, 184, 0.3), transparent 50%);
    }

    hr {
      border: none;
      border-top: 1px solid rgba(148, 163, 184, 0.16);
      margin: 20px 0;
    }

    section {
      margin-top: 22px;
    }

    h2 {
      font-size: 1.4rem;
      position: relative;
      padding-left: 11px;
      margin-bottom: 8px;
    }

    h2::before {
      content: "";
      position: absolute;
      left: 0;
      top: 5px;
      width: 4px;
      height: 18px;
      border-radius: 999px;
      background: linear-gradient(to bottom, var(--accent), #a855f7);
    }

    h3 {
      font-size: 1.05rem;
      margin-top: 16px;
      margin-bottom: 4px;
    }

    p {
      margin: 6px 0 10px;
      color: var(--text-main);
      font-size: 0.96rem;
    }

    ul, ol {
      margin: 6px 0 12px 22px;
      color: var(--text-main);
      font-size: 0.95rem;
    }

    li + li {
      margin-top: 2px;
    }

    code {
      font-family: var(--mono);
      font-size: 0.85rem;
      background: var(--code-bg);
      padding: 1px 5px;
      border-radius: 5px;
      border: 1px solid rgba(15, 23, 42, 0.9);
    }

    pre {
      background: var(--code-bg);
      border-radius: var(--radius-md);
      padding: 10px 12px;
      overflow-x: auto;
      border: 1px solid rgba(15, 23, 42, 0.9);
      box-shadow: var(--shadow-subtle);
      margin: 10px 0 14px;
    }

    pre code {
      background: transparent;
      padding: 0;
      border: none;
    }

    .callout {
      border-radius: var(--radius-md);
      padding: 10px 12px;
      font-size: 0.9rem;
      display: flex;
      gap: 8px;
      align-items: flex-start;
      margin: 12px 0;
    }

    .callout.info {
      background: var(--accent-soft);
      border: 1px solid rgba(79, 209, 197, 0.6);
    }

    .callout.danger {
      background: var(--danger-soft);
      border: 1px solid rgba(245, 101, 101, 0.7);
    }

    .callout-icon {
      font-size: 1rem;
      line-height: 1.1;
      margin-top: 1px;
    }

    .callout-body {
      color: var(--text-main);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 8px 0 16px;
      font-size: 0.9rem;
    }

    th, td {
      padding: 7px 9px;
      border-bottom: 1px solid var(--border-subtle);
    }

    th {
      text-align: left;
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      font-weight: 600;
    }

    tr:nth-child(even) td {
      background: rgba(15, 23, 42, 0.65);
    }

    kbd {
      font-family: var(--mono);
      font-size: 0.8rem;
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.8);
      box-shadow: 0 1px 0 rgba(0,0,0,0.3);
      color: var(--text-main);
    }

    .list-inline {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 8px;
      padding-left: 0;
      list-style: none;
      margin: 0;
    }

    .list-inline li::before {
      content: "• ";
      color: var(--accent-strong);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 12px;
      flex-wrap: wrap;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-muted);
    }

    .two-col {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 18px;
    }

    @media (max-width: 800px) {
      body {
        padding: 16px 10px 32px;
      }
      .card {
        padding: 20px 16px 24px;
      }
      .two-col {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <article class="card">
      <header>
        <div class="section-header">
          <div>
            <h1>WoW Key Repeat + Overlay System</h1>
            <p class="subtitle">
              Two AutoHotkey scripts working together: one for key repeating in World of Warcraft, and one for a tiny status overlay (Running / Suspended) on your second monitor.
            </p>
          </div>
          <div class="badge">AutoHotkey v1 • Windows 11</div>
        </div>
        <div class="pill-row">
          <span class="pill">Key repeat automation</span>
          <span class="pill">In-game status overlay</span>
          <span class="pill">Suspend / resume tracking</span>
          <span class="pill">Persistent position &amp; lock state</span>
        </div>
      </header>

      <hr />

      <section id="overview">
        <h2>1. Overview</h2>
        <p>
          This system uses <strong>two separate AHK v1 scripts</strong>:
        </p>
        <ul>
          <li><strong>Key Repeat Script (wow_key_repeat_with_log.ahk)</strong> &mdash; handles repeated key presses in World of Warcraft and logs when it is suspended or unsuspended.</li>
          <li><strong>Overlay Monitor Script (wow_key_repeat_script_monitor_overlay.ahk)</strong> &mdash; displays a minimal overlay on your second monitor showing whether the key script is currently <strong>Running (R)</strong> or <strong>Suspended (S)</strong>.</li>
        </ul>
        <p>
          The scripts communicate via a simple text log file, and the overlay persists its own settings (position and lock state) in a separate INI file.
        </p>
      </section>

      <section id="key-repeat">
        <div class="section-header">
          <h2>2. Key Repeat Script</h2>
          <span class="tag">Component A</span>
        </div>

        <h3>2.1 Purpose</h3>
        <p>
          The Key Repeat Script is responsible for:
        </p>
        <ul>
          <li>Repeating specific keys while they are held down in World of Warcraft.</li>
          <li>Allowing the script to be <strong>suspended and unsuspended</strong> (typically via a hotkey like <kbd>PgDn</kbd>).</li>
          <li>Logging every suspend / unsuspend action to a text file.</li>
        </ul>

        <h3>2.2 Log File</h3>
        <p>
          The script writes to a plain-text log file located <strong>in the same directory as the Key Repeat script</strong>:
        </p>
        <pre><code>suspend_log.txt</code></pre>

        <p>Each time the script is suspended or unsuspended, it appends a line similar to:</p>
        <pre><code>2025-01-12 14:33:21 suspended
2025-01-12 14:33:40 unsuspended
</code></pre>

        <p>
          The <strong>Overlay Monitor Script</strong> reads only the <strong>last non-empty line</strong> of this file to determine the current state.
        </p>

        <div class="callout info">
          <div class="callout-icon">ℹ️</div>
          <div class="callout-body">
            The Key Repeat Script itself never deletes this log. The Overlay script clears
            <code>suspend_log.txt</code> when you exit the overlay using its tray menu.
          </div>
        </div>
      </section>

      <section id="overlay">
        <div class="section-header">
          <h2>3. Overlay Monitor Script</h2>
          <span class="tag">Component B</span>
        </div>

        <h3>3.1 Purpose</h3>
        <p>
          The Overlay Monitor Script provides a tiny on-screen indicator on your second monitor that shows the current state of the Key Repeat Script:
        </p>
        <ul>
          <li><strong>R</strong> (green) &mdash; script is <strong>Running</strong> (unsuspended)</li>
          <li><strong>S</strong> (red) &mdash; script is <strong>Suspended</strong></li>
        </ul>

        <h3>3.2 Display Rules</h3>
        <p>
          The overlay will only be visible when:
        </p>
        <ul>
          <li><strong>World of Warcraft is running</strong>, and</li>
          <li><strong>Either</strong>:
            <ul>
              <li>World of Warcraft is the active (foreground) window, <strong>or</strong></li>
              <li>The overlay window itself is the active window (e.g. while you’re dragging it).</li>
            </ul>
          </li>
        </ul>
        <p>
          The overlay automatically hides when:
        </p>
        <ul>
          <li>World of Warcraft is not running, or</li>
          <li>Some other application is active <em>and</em> the overlay is not active.</li>
        </ul>

        <h3>3.3 Behavior &amp; Features</h3>
        <div class="two-col">
          <div>
            <ul>
              <li><strong>Borderless</strong>, always-on-top overlay window with rounded corners.</li>
              <li>Small square, centered single-character display:
                <ul class="list-inline">
                  <li><strong>R</strong> = running (green background)</li>
                  <li><strong>S</strong> = suspended (red background)</li>
                </ul>
              </li>
              <li>Locked overlay:
                <ul>
                  <li>~60% transparency (semi-transparent)</li>
                  <li>Click-through (doesn’t block your WoW UI)</li>
                  <li>Cannot be dragged while locked</li>
                </ul>
              </li>
              <li>Unlocked overlay:
                <ul>
                  <li>Fully opaque</li>
                  <li>Draggable by clicking anywhere on the overlay</li>
                </ul>
              </li>
            </ul>
          </div>
          <div>
            <ul>
              <li>Overlay shows on your second monitor (you can drag it anywhere).</li>
              <li>Overlay position is <strong>persisted</strong> between sessions.</li>
              <li>Lock/unlock state is also persisted between sessions.</li>
              <li>Overlay only checks the log file while WoW is considered "visible" (per the rules above).</li>
              <li>On exit via tray:
                <ul>
                  <li>Position and lock state are saved to the INI file.</li>
                  <li><code>suspend_log.txt</code> is deleted.</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>

        <h3>3.4 Locking &amp; Unlocking</h3>
        <p>You can toggle the overlay lock state in two ways:</p>
        <ul>
          <li><strong>Right-click the overlay</strong> (when it is unlocked and receiving clicks).</li>
          <li><strong>Right-click the tray icon</strong> &rarr; <code>Toggle Lock Overlay</code>.</li>
        </ul>
        <p>When locked:</p>
        <ul>
          <li>The tray menu item <strong>Toggle Lock Overlay</strong> is checked.</li>
          <li>The overlay becomes semi-transparent and ignores mouse clicks (click-through).</li>
        </ul>
        <p>When unlocked:</p>
        <ul>
          <li>The tray menu item is unchecked.</li>
          <li>The overlay becomes fully opaque and can be dragged around.</li>
        </ul>
      </section>

      <section id="settings">
        <div class="section-header">
          <h2>4. Settings File</h2>
          <span class="tag">Overlay configuration</span>
        </div>

        <p>
          The Overlay Monitor Script stores its configuration in a dedicated INI file under your roaming AppData:
        </p>

        <pre><code>%AppData%\WoWScriptOverlay\overlay_settings.ini</code></pre>

        <p>Typical contents:</p>

        <pre><code>[Overlay]
X=769
Y=1307
Locked=1
</code></pre>

        <h3>4.1 Fields</h3>
        <table>
          <thead>
            <tr>
              <th>Key</th>
              <th>Meaning</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>X</code>, <code>Y</code></td>
              <td>Last saved screen coordinates of the overlay's top-left corner.</td>
            </tr>
            <tr>
              <td><code>Locked</code></td>
              <td>
                <code>1</code> = overlay starts locked (transparent &amp; click-through).<br />
                <code>0</code> = overlay starts unlocked (opaque &amp; draggable).
              </td>
            </tr>
          </tbody>
        </table>

        <h3>4.2 When the INI is updated</h3>
        <ul>
          <li><strong>On lock:</strong>
            <ul>
              <li>Current X/Y position is saved.</li>
              <li><code>Locked=1</code> is written to the INI.</li>
            </ul>
          </li>
          <li><strong>On unlock:</strong>
            <ul>
              <li><code>Locked=0</code> is written to the INI.</li>
            </ul>
          </li>
          <li><strong>On exit via tray &rarr; Exit Overlay:</strong>
            <ul>
              <li>Latest position is saved again.</li>
              <li>Lock state is saved.</li>
              <li>The log file <code>suspend_log.txt</code> is deleted.</li>
            </ul>
          </li>
        </ul>
      </section>

      <section id="interaction">
        <h2>5. Interaction Between Scripts</h2>

        <h3>5.1 High-level flow</h3>
        <ol>
          <li>
            <strong>Key Repeat Script runs</strong><br />
            As you suspend/unsuspend the script (e.g. via <kbd>PgDn</kbd>), it appends lines to:
            <pre><code>suspend_log.txt</code></pre>
          </li>
          <li>
            <strong>Overlay Monitor Script runs</strong><br />
            It:
            <ul>
              <li>Tracks whether World of Warcraft is running.</li>
              <li>Shows the overlay only when WoW or the overlay itself has focus.</li>
              <li>Reads the latest entry from <code>suspend_log.txt</code> when visible.</li>
            </ul>
          </li>
          <li>
            <strong>Overlay interprets the log</strong><br />
            <ul>
              <li>Last line contains <code>unsuspended</code> &rarr; overlay shows <strong>R</strong> (green).</li>
              <li>Last line contains <code>suspended</code> &rarr; overlay shows <strong>S</strong> (red).</li>
              <li>Log file is missing or empty &rarr; overlay assumes <strong>Running (R)</strong>.</li>
            </ul>
          </li>
          <li>
            <strong>Overlay hides itself</strong> whenever WoW is not visible by the rule:
            <ul>
              <li>If WoW is not running, or</li>
              <li>If neither WoW nor the overlay are the active window.</li>
            </ul>
          </li>
          <li>
            <strong>On overlay exit via tray</strong>, the script:
            <ul>
              <li>Saves the last known position and lock state to <code>overlay_settings.ini</code>.</li>
              <li>Deletes <code>suspend_log.txt</code> to start fresh next time.</li>
              <li>Exits cleanly.</li>
            </ul>
          </li>
        </ol>
      </section>

      <section id="usage">
        <h2>6. How to Use</h2>

        <h3>6.1 Setup</h3>
        <ol>
          <li>Place your <strong>Key Repeat Script</strong> (e.g. <code>key_repeat.ahk</code>) in a folder of your choice.</li>
          <li>Place the <strong>Overlay Monitor Script</strong> (e.g. <code>wow_overlay.ahk</code>) in any folder (it uses <code>%AppData%</code> for settings).</li>
          <li>Ensure AutoHotkey v1 is installed on your system.</li>
        </ol>

        <h3>6.2 Running</h3>
        <ol>
          <li>Run the <strong>Key Repeat Script</strong>.</li>
          <li>Run the <strong>Overlay Monitor Script</strong>.</li>
          <li>Launch <strong>World of Warcraft</strong>.</li>
          <li>When WoW is active, the overlay will appear on your screen.</li>
        </ol>

        <h3>6.3 Position &amp; Lock Workflow</h3>
        <ol>
          <li>Make sure the overlay is <strong>unlocked</strong>:
            <ul>
              <li>Right-click the tray icon &rarr; <code>Toggle Lock Overlay</code> (ensure it is unchecked), or</li>
              <li>If currently locked, toggle again to unlock.</li>
            </ul>
          </li>
          <li><strong>Drag</strong> the overlay by clicking and dragging anywhere on it.</li>
          <li><strong>Lock</strong> it in place:
            <ul>
              <li>Right-click the overlay, or</li>
              <li>Right-click the tray icon &rarr; <code>Toggle Lock Overlay</code>.</li>
            </ul>
          </li>
          <li>Once locked:
            <ul>
              <li>The overlay becomes semi-transparent.</li>
              <li>It becomes click-through (does not block your WoW UI).</li>
              <li>Its position and <code>Locked=1</code> status are saved.</li>
            </ul>
          </li>
        </ol>

        <h3>6.4 Exiting</h3>
        <p>
          To exit the overlay cleanly:
        </p>
        <ol>
          <li>Right-click the tray icon.</li>
          <li>Select <strong>Exit Overlay</strong>.</li>
        </ol>
        <p>This will:</p>
        <ul>
          <li>Save the current position to <code>overlay_settings.ini</code>.</li>
          <li>Save the lock state (<code>Locked=0/1</code>).</li>
          <li>Delete <code>suspend_log.txt</code>.</li>
        </ul>
      </section>

      <section id="files">
        <h2>7. Files &amp; Locations</h2>

        <h3>7.1 Key Repeat Script Folder</h3>
        <pre><code>YourKeyScriptFolder\
    key_repeat.ahk
    suspend_log.txt       &lt;-- created and written by key script
</code></pre>

        <h3>7.2 Overlay Settings Folder</h3>
        <pre><code>C:\Users\&lt;YourUser&gt;\AppData\Roaming\WoWScriptOverlay\
    overlay_settings.ini  &lt;-- created and maintained by overlay script
</code></pre>

        <h3>7.3 Overlay Script Folder</h3>
        <pre><code>YourOverlayScriptFolder\
    wow_overlay.ahk
</code></pre>
      </section>

      <section id="performance">
        <h2>8. Performance Impact</h2>

        <p>
          Both scripts are extremely lightweight and designed to have negligible impact on system performance.
        </p>

        <h3>8.1 Key Repeat Script</h3>
        <ul>
          <li><strong>Idle:</strong> Essentially 0% CPU (it waits on hotkeys).</li>
          <li><strong>While repeating keys:</strong> Performs simple loops with <code>Sleep</code>, usually well under a couple percent CPU even under heavy usage.</li>
          <li><strong>Memory:</strong> Just a few MB of RAM.</li>
        </ul>

        <h3>8.2 Overlay Monitor Script</h3>
        <ul>
          <li>Checks if WoW/overlay is active once per second.</li>
          <li>Reads the small log file once per second, but only while the overlay is visible.</li>
          <li>Uses minimal CPU and small amounts of RAM.</li>
        </ul>

        <div class="callout info">
          <div class="callout-icon">✅</div>
          <div class="callout-body">
            On any reasonably modern Windows 11 PC, you should not notice any performance impact from running these two scripts alongside World of Warcraft.
          </div>
        </div>
      </section>
    </article>
  </div>
</body>
</html>
